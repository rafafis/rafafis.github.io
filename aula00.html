<!DOCTYPE html>
<html lang="pt-br">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>3º Anos - Física I</title>
	<link rel="stylesheet" href="../style.css">
	<!-- JS -->
	<script src="../scripts.js" defer></script>
	<!-- Scripts do MathJax -->
	<script id="MathJax-script" async
		src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
	</script>
</head>

<body>
    <header>
        <h1>3º Anos</h1>
		<br>
        <h1>Física I</h1>
    </header>

	#include <TM1637Display.h>

// Definições dos pinos do display
#define CLK 2
#define DIO 3

// Definições dos pinos do sensor ultrassônico HC-SR04
#define TRIG_PIN 4
#define ECHO_PIN 5

// Cria o objeto display
TM1637Display display(CLK, DIO);

void setup() {
  // Inicializa comunicação serial para debug (opcional)
  Serial.begin(9600);

  // Configura o brilho do display
  display.setBrightness(0x0f); // Brilho máximo

  // Configura os pinos do sensor ultrassônico
  pinMode(TRIG_PIN, OUTPUT);
  pinMode(ECHO_PIN, INPUT);

  // Teste inicial do display
  display.showNumberDec(8888, true);
  delay(1000);
  display.clear();
}

void loop() {
  // Mede a distância
  float distancia = medirDistancia();

  // Converte para centímetros e limita a 9999 cm
  int distanciaCm = (int)distancia;
  if (distanciaCm > 9999) {
    distanciaCm = 9999;
  }

  // Exibe no display
  display.showNumberDec(distanciaCm, true);

  // Debug no monitor serial (opcional)
  Serial.print("Distância: ");
  Serial.print(distanciaCm);
  Serial.println(" cm");

  // Pequeno delay para estabilizar as leituras
  delay(100);
}

float medirDistancia() {
  // Limpa o pino TRIG
  digitalWrite(TRIG_PIN, LOW);
  delayMicroseconds(2);

  // Envia um pulso de 10 microssegundos
  digitalWrite(TRIG_PIN, HIGH);
  delayMicroseconds(10);
  digitalWrite(TRIG_PIN, LOW);

  // Lê o tempo de retorno do pulso
  long duracao = pulseIn(ECHO_PIN, HIGH);

  // Calcula a distância em centímetros
  // Velocidade do som = 343 m/s = 0.0343 cm/µs
  // Distância = (tempo * velocidade) / 2
  float distancia = (duracao * 0.0343) / 2;

  return distancia;
}
</body>
</html>
